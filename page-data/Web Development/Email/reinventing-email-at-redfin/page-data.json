{"componentChunkName":"component---src-templates-blog-post-js","path":"/Web Development/Email/reinventing-email-at-redfin/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p>This was <a href=\"http://blog.redfin.com/devblog/?p=634\">originally published on the Redfin developer blog</a></p>\n</blockquote>\n<img class=\"bodyimg right\" src=\"http://f.cl.ly/items/2V1v3l0V1a030M340p0F/iphone_sample.PNG\" alt=\"Old, unresponsive Redfin email on iPhone\">\n<p>Depending on what you read, around a third of the time spent on mobile devices is taken up by email. Redfin is being increasingly accessed from mobile devices. It’s the 21st century, and we’ve all got computers in our pockets.</p>\n<p>Why, then, are we sending out emails that are formatted exclusively for desktop email clients? Not even necessarily all that well, honestly. If you’re reading them on something like a MacBook Air or an ultrabook/netbook sort of machine, our font size choices are probably making that whole situation pretty tough. That said, we have some good looking templates that heavily favor desktop reading, thanks to font sizes, header elements, and (most important) multi-column layouts.</p>\n<!-- more -->\n<h3>The future of email is here, and it looks a lot like the past.</h3>\n<p>I started working on Redfin’s emails late last year, and we immediately started cleaning things up. Fewer tables, larger font sizes, less clutter. You probably didn’t notice, or if you did you didn’t think much about it. They look pretty good, but our email is nothing special. And everything we were sending was 100% tables, with weird hacks to get around Outlook 2007 &#x26; 2010. For desktop only, that’s fine, but what about for mobile? Android and iOS both boast incredibly modern WebKit-based default mail clients, supporting HTML5 and CSS3 (including things like inline video!). But the work involved in designing and coding a separate ‘mobile’ email campaign is pretty intimidating, and the idea of going through every email we send and redesigning wasn’t particularly appealing either.</p>\n<p>What do you do, then? Lots of desktop/mobile email templates out there seem to reformat the existing table cells as <a href=\"http://goo.gl/b2h4U\" title=\"preview.smartfocusdigital.com\">narrower versions for mobile</a>, but that’s kind of a cop-out. They look good, and the responsive layout might be nifty, but they still run the risk of tiny text areas. So, designing emails to have secondary content that can collapse doesn’t really solve the problem of an email that is truly accessible to mobile users. It also doesn’t address the issue of the design &#x26; coding workload required to get new templates designed, built, and tested.</p>\n<p>I mentioned earlier that mobile email clients (except for Gmail, on any platform) are fancy and modern; what does this actually mean for the old-school table layouts, though? That got me thinking: what if we could convince these clients that they should ignore the fact that the content is in a table? Most web developers probably use <code>display:block;</code> on inline elements like all the time, so why not on table cells? Obviously if you’re writing semantic code and using tables for tabular data, this makes no sense, but if you’re writing <em>emails</em> and using tables for <em>layout</em>, this seems like the perfect solution. It took some experimentation, but I found that, yes, we can turn a <code>td</code> into a block element that we can manipulate as a pseudo-div.</p>\n<h3>Breaking tables (deliberately)</h3>\n<p>First, we set up a media query that will only be triggered by small screens. This isn’t anything new if you’ve worked with CSS3 and <a href=\"http://goo.gl/XiBqN\" title=\"alistapart.com\">responsive design</a>. Within the media query, we build a simple class that can be assigned to whatever we want to reformat for mobile.</p>\n<pre><code>&#x3C;style type=\"text/css\">\n    @media only screen and (max-device-width: 480px) {\n        *[class~=stackonmobile] {\n            display: block !important;\n            clear: both !important;\n            width: 100% !important;\n            margin: 0;\n        }\n        *[class~=hideonmobile] {\n            display: none !important;\n        }\n    }\n&#x3C;/style>\n</code></pre>\n<p>There’s some weird bits to that CSS, especially in the selectors we’re using to pick out <code>.stackonmobile</code> and <code>.hideonmobile</code> - <a href=\"http://goo.gl/qV13N\" title=\"campaignmonitor.com\">you can thank Yahoo Mail for that</a>. Anyway, this is a class that you’ll want to apply after inlining your css, if you use a tool like <a href=\"http://goo.gl/sNZe9\" title=\"premailer.dialect.ca\">premailer</a>. Also, for testing and development, it can help if you use <code>max-width</code> rather than <code>max-device-width</code> - this lets you resize your browser and see your revisions live.</p>\n<pre><code>&#x3C;table class=\"stackonmobile\">\n    &#x3C;tr>\n        &#x3C;td class=\"stackonmobile\">\n        &#x3C;/td>\n        &#x3C;td class=\"stackonmobile\">\n        &#x3C;/td>\n    &#x3C;/tr>\n    &#x3C;tr>\n        &#x3C;td class=\"hideonmobile\" colspan=\"2\">\n        &#x3C;/td>\n    &#x3C;/tr>\n&#x3C;/table>\n</code></pre>\n<img class=\"bodyimg right\" src=\"http://f.cl.ly/items/232p0d0o1y2m0S29000F/Screen%20Shot%202012-03-14%20at%202.00.44%20PM.png\" width=\"200\" alt=\"Same email, converted to a responsive layout, on iPhone\">\n<p>When viewed in an email client or web browser, you’ll see a normal table with two columns, and a second row spanning both. When you hit the same page in a mobile browser, or view the email on an iOS or Android device with a small screen, you’ll get a single-column layout. <a href=\"http://cl.ly/092N0B3X2O303a2T082U/4_sample.html\">Take a look at one of our emails</a> to see what I’ve been talking about. We’ve used one set of HTML, but adapted the layout from a horizontal grid to a vertical one, perfect for the narrow confines of a mobile screen. Is it a bit hacky? Yes. Is it valid HTML and CSS? Technically, yes!</p>\n<p>We’re gradually rolling out this new format to all the email we send. If you’re a Redfin user and we send you email, please let us know if you have suggestions or see bugs!</p>\n<p>Thanks to:</p>\n<ul>\n<li><a href=\"http://litmus.com/blog\">Litmus</a> (awesome browser testing and great articles)</li>\n<li><a href=\"http://www.campaignmonitor.com/blog\">Campaign Monitor</a> (more great articles, and some awesome resources on compatibility)</li>\n</ul>\n<h3>Sadly, there is a disclaimer!</h3>\n<p>Of course, there are a few compatibility problems. IE and IE mobile (and by extension, the Windows Phone 7.x email client, which otherwise seems quite nice) apparently <a href=\"http://stackoverflow.com/questions/5091503/how-can-i-make-display-block-work-on-a-td-in-ie\">doesn’t know that you can apply <code>display:block;</code> to a table cell</a>. As a result, they apply the styles erroneously or not at all (visit the <a href=\"http://cl.ly/092N0B3X2O303a2T082U/4_sample.html\">sample</a> in Internet Explorer to see an example of this in action). We get very few opens on Windows Phone, so we deemed it an acceptable risk, but we’re keeping an eye on stats and we are hoping to eventually find some solutions.</p>\n<p>If you’ve got a lot of subscribers reading your email on Windows Phone, this probably isn’t the solution for you.</p>","frontmatter":{"title":"Reinventing Email at Redfin","date":"2012-04-19 12:00","camera":null,"description":"Why are we sending out emails that are formatted exclusively for desktop email clients? Not even necessarily all that well, honestly."},"fields":{"slug":"Web Development/Email/reinventing-email-at-redfin/"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"Web Development/Email/reinventing-email-at-redfin/"}}}